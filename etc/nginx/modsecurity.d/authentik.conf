# Level 1
SecRuleRemoveById 931100
SecRuleRemoveById 934110

# Level 2
SecRuleUpdateTargetById 920230 !ARGS:next
SecRuleUpdateTargetById 920230 !ARGS:query
SecRuleUpdateTargetById 920230 !ARGS:state

SecRuleRemoveById 931130
#SecRuleUpdateTargetById 931130 !ARGS:json.config.authentik_host
#SecRuleUpdateTargetById 931130 !ARGS:json.logout_uri
#SecRuleUpdateTargetById 931130 !ARGS:json.provider.external_host
#SecRuleUpdateTargetById 931130 !ARGS:json.redirect_uris.array_0.url
#SecRuleUpdateTargetById 931130 !ARGS:json.redirect_uris.array_1.url
#SecRuleUpdateTargetById 931130 !ARGS:post_logout_redirect_uri
#SecRuleUpdateTargetById 931130 !ARGS:redirect_uri

SecRuleUpdateTargetById 932200 !ARGS:next
SecRuleUpdateTargetById 932200 !ARGS:query

SecRuleUpdateTargetById 932236 !ARGS:context_model_name
SecRuleUpdateTargetById 932236 !ARGS:content_type__model
SecRuleUpdateTargetById 932236 !ARGS:json.meta_description

SecRuleUpdateTargetById 942120 !ARGS:json.webauthn.response.authenticatorData
SecRuleUpdateTargetById 942120 !ARGS:json.webauthn.response.signature

SecRuleUpdateTargetById 942200 !ARGS:claims
SecRuleUpdateTargetById 942200 !ARGS:next
SecRuleUpdateTargetById 942200 !ARGS:query
SecRuleUpdateTargetById 942200 !ARGS:state
SecRuleUpdateTargetById 942200 !REQUEST_HEADERS:referer

SecRuleUpdateTargetById 942340 !ARGS:claims
SecRuleUpdateTargetById 942340 !ARGS:next
SecRuleUpdateTargetById 942340 !ARGS:query
SecRuleUpdateTargetById 942340 !ARGS:state

SecRuleUpdateTargetById 942370 !ARGS:claims
SecRuleUpdateTargetById 942370 !ARGS:next
SecRuleUpdateTargetById 942370 !ARGS:query
SecRuleUpdateTargetById 942370 !REQUEST_HEADERS:referer

SecRuleUpdateTargetById 942430 !ARGS:claims
SecRuleUpdateTargetById 942430 !ARGS:json.token
SecRuleUpdateTargetById 942430 !ARGS:next
SecRuleUpdateTargetById 942430 !ARGS:query
SecRuleUpdateTargetById 942430 !ARGS:state

SecRuleUpdateTargetById 942440 !ARGS:json.response.rawId
SecRuleUpdateTargetById 942440 !ARGS:json.token

# Level 3
SecRuleRemoveById 920272
#SecRuleUpdateTargetById 920272 !REQUEST_BODY
#SecRuleUpdateTargetById 920272 !REQUEST_HEADERS:referer
#SecRuleUpdateTargetById 920272 !REQUEST_URI_RAW

SecRuleUpdateTargetById 921180 !TX:paramcounter_ARGS_NAMES:actions
SecRuleUpdateTargetById 921180 !TX:paramcounter_ARGS_NAMES:type

SecRuleUpdateTargetById 921230 !REQUEST_HEADERS:Range

SecRuleUpdateTargetById 932190 !ARGS:next
SecRuleUpdateTargetById 932190 !ARGS:redirect_uri

SecRuleUpdateTargetById 942431 !ARGS:claims
SecRuleUpdateTargetById 942431 !ARGS:json.token
SecRuleUpdateTargetById 942431 !ARGS:next
SecRuleUpdateTargetById 942431 !ARGS:query
SecRuleUpdateTargetById 942431 !ARGS:json.response.response.attestationObject
SecRuleUpdateTargetById 942431 !ARGS:state

SecRuleUpdateTargetById 942460 !ARGS:claims

# Level 4        
SecRuleRemoveById 920273
#SecRuleUpdateTargetById 920273 !ARGS:next
#SecRuleUpdateTargetById 920273 !ARGS:query
#SecRuleUpdateTargetById 920273 !REQUEST_BODY

SecRuleRemoveById 942432
#SecRuleUpdateTargetById 942432 !ARGS:json.webauthn.assertionClientExtensions
#SecRuleUpdateTargetById 942432 !ARGS:json.webauthn.response.authenticatorData
#SecRuleUpdateTargetById 942432 !ARGS:json.webauthn.response.signature
#SecRuleUpdateTargetById 942432 !ARGS:redirect_uri

# Disable rules for the username field
SecRuleUpdateTargetByTag OWASP_CRS !ARGS:json.uid_field

# Disable rules for the password field
SecRuleUpdateTargetByTag OWASP_CRS !ARGS:json.password
SecRuleUpdateTargetByTag OWASP_CRS !ARGS:json.password_repeat

# Disable rules for policies
SecRuleUpdateTargetByTag OWASP_CRS !ARGS:json.expression

# Cremean\'s rules for Cloudflare Turnsile
SecRuleUpdateTargetById 920273 !ARGS:cf-turnstile-response
SecRuleUpdateTargetById 942430 !ARGS:cf-turnstile-response
SecRuleUpdateTargetById 942431 !ARGS:cf-turnstile-response
SecRuleUpdateTargetById 942432 !ARGS:cf-turnstile-response
SecRuleUpdateTargetById 942440 !ARGS:cf-turnstile-response
SecRuleUpdateTargetById 942450 !ARGS:cf-turnstile-response
